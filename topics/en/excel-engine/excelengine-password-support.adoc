////
|metadata|
{
    "name": "excelengine-password-support",
    "controlName": ["Infragistics Excel Engine"],
    "tags": ["How Do I"],
    "guid": "c6578559-654c-4d34-a3f6-7dc949dad11b",
    "buildFlags": [],
    "createdOn": "2014-03-21T13:03:28.3592037Z"
}
|metadata|
////

= Password Support ({ExcelEngineName})

== Topic Overview

=== Purpose

This topic explains how to operate with password encrypted files.

=== Required background

The following topics are prerequisites to understanding this topic:

[options="header", cols="a,a"]
|====
|Topic|Purpose

| link:excelengine-about-infragistics-excel-engine.html[About {ExcelEngineName}]
|In this topic you'll find information that will help you to better understand the object model and the functionalities of the {ExcelEngineName}.

| link:excelengine-load-an-excel-file.html[Load an Excel File]
|This topic explains how to read an existing Excel file.

|====

=== In this topic

This topic contains the following sections:

* <<_Ref382212727,Introduction>>
* <<_Ref382320381,Operate with Open Password Encrypted Workbook>>
ifdef::wpf[]
* <<_Ref382320406,Operate with Write Protected Workbook>>
endif::wpf[]
* <<_Ref382320414,Related Content>>

[[_Ref382212727]]
== Introduction

=== Password support summary

The {ExcelEngineName}’s password support provides you the following abilities for working with encrypted/protected workbooks:

* inspecting whether a workbook is encrypted with an open password
ifdef::wpf[]
* inspecting whether an opened workbook is write protected
* loading and saving password encrypted workbooks
* validating write protected workbooks
* setting or clearing the open password of an encrypted workbook
* setting or clearing the password for a write protected workbook
endif::wpf[]

[[_Ref382320381]]
== Operate with Open Password Encrypted Workbook

=== Overview

The following table lists the properties and methods associated with dealing with open password encrypted workbooks.

=== Description

[options="header", cols="a,a"]
|====
|For the following task|Use this property/method

|Inspect an unopened workbook for an open password.
|
ifdef::wpf[]
link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~isworkbookencrypted.html[IsWorkbookEncrypted(string)]
endif::wpf[]

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~isworkbookencrypted.html[IsWorkbookEncrypted(Stream)] 

.Note 
[NOTE] 
====
ifdef::wpf[]
When using the method with the `Stream` argument and the check is performed, this method will reset the stream position to the original value if `Stream.CanSeek` is true.
endif::wpf[]
ifdef::xamarin[]
When using this method and the check is performed, this method will reset the stream position to the original value if `Stream.CanSeek` is true.
endif::xamarin[]
====

ifdef::wpf[]
|Load a workbook encrypted with an open password.
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~load.html[Load(string, WorkbookLoadOptions)] 

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~load.html[Load(SecureString, WorkbookLoadOptions)] 

.Note 
[NOTE] 
==== 
If the password is supplied both as `string` and `SecureString` (in the link:{ExcelEngineApiLink}infragistics.documents.excel.workbookloadoptions_members.html[WorkbookLoadOptions] argument), the one of type string will be used, because it requires no permission to obtain the string value. 
====

|Inspect an opened workbook for an open password.
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~hasopenpassword.html[HasOpenPassword] 

.Note 
[NOTE] 
==== 
This property returns true if the necessary open password was supplied and the file was opened successfully. This property also returns true if a subsequent save will save the workbook with an open password. 
====

|Set, change or clear the open password on an opened workbook.
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~setopenpassword.html[SetOpenPassword(string)] 

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~setopenpassword.html[SetOpenPassword(SecureString)] 

.Note 
[NOTE] 
==== 
If you provide null or empty string, this will clear the current open password. 
====
endif::wpf[]
|====
ifdef::wpf[]
[[_Ref382320406]]
== Operate with Write Protected Workbook

=== Overview

The following table lists the properties and methods associated with dealing with write protected workbooks.

=== Description

[options="header", cols="a,a"]
|====
|For the following task|Use this property/method

|Inspect an opened workbook for write protection.
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~hasfilewriteprotectionpassword.html[HasFileWriteProtectionPassword] 

.Note 
[NOTE] 
==== 
This property indicates whether subsequently saved files will be write protected. You can only save write protected files when the correct password is validated using the `ValidateFileWriteProtectionPassword` or a new password is set using `SetFileWriteProtectionPassword`. 
====

|Check an opened workbook whether it has write protection and is the password validated.
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~isfilewriteprotected.html[IsFileWriteProtected] 

.Note 
[NOTE] 
==== 
This property returns true only if the opened workbook is write protected and the required password is still not provided. You should not allow automatic saves to the original location when this property returns true. If the correct password is provided this property will return false. 
====

|Validate the write protection password of an opened workbook.
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~validatefilewriteprotectionpassword.html[ValidateFileWriteProtectionPassword(string)] 

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~validatefilewriteprotectionpassword.html[ValidateFileWriteProtectionPassword(SecureString)] 

.Note 
[NOTE] 
==== 
These methods return true if the workbook is write protected and the provided password was correct. The provided password will be cached and will be used for subsequent saves. 
====

|Set, change or clear the write protection password on an opened workbook.
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~setfilewriteprotectionpassword.html[SetFileWriteProtectionPassword(string)] 

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~setfilewriteprotectionpassword.html[SetFileWriteProtectionPassword(SecureString)] 

.Note 
[NOTE] 
==== 
If you provide null or empty string, this will clear the current write protection password. 
====

|====
endif::wpf[]
[[_Ref382320414]]
== Related Content

=== Topics

The following topics provide additional information related to this topic.

[options="header", cols="a,a"]
|====
|Topic|Purpose

| link:excelengine-save-a-workbook.html[Save a Workbook]
|This topic explains how to save a Workbook object as an Excel file.

|====
