////
|metadata|
{
    "name": "excelengine-password-support",
    "controlName": ["Infragistics Excel Engine"],
    "tags": ["How Do I"],
    "guid": "c6578559-654c-4d34-a3f6-7dc949dad11b",
    "buildFlags": [],
    "createdOn": "2014-03-21T13:03:28.3592037Z"
}
|metadata|
////

= パスワード サポート ({ExcelEngineName})

== トピックの概要

=== 目的

このトピックは、パスワードで暗号化されたファイルを操作する方法について説明します。

=== 前提条件

このトピックをより理解するために、以下のトピックを参照することをお勧めします。

[options="header", cols="a,a"]
|====
|トピック|目的

| link:excelengine-about-infragistics-excel-engine.html[{ExcelEngineName} について]
|このトピックでは、{ExcelEngineName} のオブジェクト モデルと機能をより深く理解するうえで役立つ情報を提供します。

| link:excelengine-load-an-excel-file.html[Excel ファイルの読み込み]
|このトピックでは、既存の Excel ファイルを読み込む方法を説明します。

|====

=== このトピックの内容

このトピックは、以下のセクションで構成されます。

* <<_Ref382212727,はじめに>>
* <<_Ref382320381,読み取りパスワードで暗号化されたブックの操作>>
ifdef::wpf[]
* <<_Ref382320406,書き込み禁止に設定されたブックの操作>>
endif::wpf[]
* <<_Ref382320414,関連コンテンツ>>

[[_Ref382212727]]
== はじめに

=== パスワード サポートの概要

{ExcelEngineName} のパスワード サポートにより、暗号化または保護されたブックを取り扱う場合に以下のことができます。

* ブックが読み取りパスワードで暗号化されているかどうかの確認
ifdef::wpf[]
* 開いたブックが書き込み禁止に設定されているかどうかの確認
* パスワードで暗号化されたブックの読み込みおよび保存
* 書き込み禁止に設定されたブックの検証
* 暗号化されたブックの読み取りパスワードの設定または解除
* 書き込み禁止に設定されたブックのパスワードの設定解除
endif::wpf[]

[[_Ref382320381]]
== 読み取りパスワードで暗号化されたブックの操作

=== 概要

以下の表は、読み取りパスワードで暗号化されたブックの操作に関連したプロパティやメソッドを示しています。

=== 説明

[options="header", cols="a,a"]
|====
|タスク|使用するプロパティ / メソッド

|開いていないブックに読み取りパスワードが設定されているかどうかの確認
|
ifdef::wpf[]
link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~isworkbookencrypted.html[IsWorkbookEncrypted(string)] 
endif::wpf[]

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~isworkbookencrypted.html[IsWorkbookEncrypted(Stream)] 

.注: 
[NOTE] 
====
ifdef::wpf[]
このメソッドを `Stream` 引数を指定してチェックの実行に使用すると、このメソッドは、`Stream.CanSeek` が true の場合、ストリーム位置を元の値にリセットします。 
endif::wpf[]
ifdef::xamarin[]
このメソッドを使用してチェックを実行すると、このメソッドは、`Stream.CanSeek` が true の場合、ストリーム位置を元の値にリセットします。
endif::xamarin[]
====

ifdef::wpf[]
|読み取りパスワードで暗号化されたブックの読み込み
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~load.html[Load(string, WorkbookLoadOptions)] 

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~load.html[Load(SecureString, WorkbookLoadOptions)] 

.注: 
[NOTE] 
==== 
パスワードが`string`と `SecureString` ( link:{ExcelEngineApiLink}infragistics.documents.excel.workbookloadoptions_members.html[WorkbookLoadOptions] 引数内で) の両方で設定されている場合、文字列型のパスワードが使用されます。これは文字列値の取得に許可が必要ないためです。 
====

|開いているブックに読み取りパスワードが設定されているかどうかの確認
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~hasopenpassword.html[HasOpenPassword] 

.注: 
[NOTE] 
==== 
読み取りパスワードが設定され、ファイルが正常に開いている場合、このプロパティは true を返します。次回保存時にこのブックを読み取りパスワードを設定した状態で保存すると、このプロパティは true を返します。 
====

|開いているブックの読み取りパスワードの設定、変更、または解除
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~setopenpassword.html[SetOpenPassword(string)] 

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~setopenpassword.html[SetOpenPassword(SecureString)] 

.注: 
[NOTE] 
==== 
null または空の文字列を設定すると、現在設定された読み取りパスワードを解除します。 
====
endif::wpf[]
|====
ifdef::wpf[]
[[_Ref382320406]]
== 書き込み禁止に設定されたブックの操作

=== 概要

以下の表は、書き込み禁止に設定されたブックの操作に関連したプロパティやメソッドを示しています。

=== 説明

[options="header", cols="a,a"]
|====
|タスク|使用するプロパティ / メソッド

|開いているブックに書き込み禁止に設定されているかどうかの確認
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~hasfilewriteprotectionpassword.html[HasFileWriteProtectionPassword] 

.注: 
[NOTE] 
==== 
このプロパティは、以後保存するファイルを書き込み禁止に設定するかどうかを示します。書き込み禁止に設定されたファイルは、`ValidateFileWriteProtectionPassword` を使用してパスワードが正しいことを検証した場合、または `SetFileWriteProtectionPassword` を使用して新しいパスワードを設定した場合に保存可能です。 
====

|開いているブックが書き込み禁止に設定されているかどうか、パスワードが検証されているかどうかの確認
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~isfilewriteprotected.html[IsFileWriteProtected] 

.注: 
[NOTE] 
==== 
このプロパティは、開いているブックが書き込み禁止に設定され、必要なパスワードがまだ入力されていない場合のみ、true を返します。このプロパティが true を返した場合は、元の場所への自動保存を許可しないでください。正しいパスワードが入力されると、このプロパティは false を返します。 
====

|開いているブックの書き込み禁止パスワードの検証
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~validatefilewriteprotectionpassword.html[ValidateFileWriteProtectionPassword(string)] 

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~validatefilewriteprotectionpassword.html[ValidateFileWriteProtectionPassword(SecureString)] 

.注: 
[NOTE] 
==== 
これらのメソッドは、ブックが書き込み禁止に設定され、正しいパスワードが入力された場合のみ、true を返します。入力されたパスワードはキャッシュされ、以後保存のたびに使用されます。 
====

|開いているブックの書き込み禁止パスワードの設定、変更、または解除
| link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~setfilewriteprotectionpassword.html[SetFileWriteProtectionPassword(string)] 

link:{ExcelEngineApiLink}infragistics.documents.excel.workbook~setfilewriteprotectionpassword.html[SetFileWriteProtectionPassword(SecureString)] 

.注: 
[NOTE] 
==== 
null または空の文字列を設定すると、現在設定されている書き込み禁止パスワードを解除します。 
====

|====
endif::wpf[]
[[_Ref382320414]]
== 関連コンテンツ

=== トピック

このトピックの追加情報については、以下のトピックも合わせてご参照ください。

[options="header", cols="a,a"]
|====
|トピック|目的

| link:excelengine-save-a-workbook.html[ブックの保存]
|このトピックでは、ブック オブジェクトを Excel ファイルとして保存する方法を説明します。

|====
