= {ShapeChartName} を ShapeFile データにバインド

このトピックは、コード例を示して、link:{ShapeChartLink}.{ShapeChartName}.html[{ShapeChartName}] コントロールをシェープファイル データにバインドする方法を説明します。

=== 前提条件
|====
|トピック|目的

|link:shapechart-getting-started-with-shapechart.html[{ShapeChartName} を使用した作業の開始]
|このトピックでは、データを {ShapeChartName} コントロールにバインドする方法を説明します。

|====

=== このトピックの内容

* <<Overview, 概要>>
* <<CodeExampleSingle, {ShapeChartName} をシェープ ファイルにバインド>>
* <<CodeExampleMulti, {ShapeChartName} を複数のシェープ ファイルにバインド>>
* <<RelatedContent, 関連コンテンツ>>

[[Overview]]
== 概要

{ShapeChartName} コントロールはシェープ ファイルをバインドして表示できます。link:{DataVizLink}.maps.shapefileconverter.html[ShapefileConverter] を ItemsSource として使用し、{ShapeChartName} の link:{ShapeChartLink}.{ShapeChartName}{ApiProp}charttype.html[ChartType] プロパティを `Polygon` に設定します。{ShapeChartName} コントロールでシェープ データを可視化する場合に便利です。たとえば、飛行機の本体または飛行機の席チャートをマップする場合、以下のコード例のように {ShapeChartName} を使用できます。

{ShapeChartName} を複数のシェープ ファイルを同時にバインドできます。複数のシェープをレイヤーでスタックする場合に便利です。`List<ShapefileConverter>` を {ShapeChartName} の `ItemsSource` として使用します。

注: このために .shp および .dbf ファイルが必要です。ShapefileConverter 要素の `DatabaseSource` および `ShapefileSource` プロパティへのパスを設定する必要があります。.shp および .dbf ファイルの BuildAction を Resource に設定することも必要です。

[[CodeExampleSingle]]
== {ShapeChartName} をシェープ ファイルにバインド

以下のコード例は単一のシェープ ファイルを {ShapeChartName} にバインドする方法を紹介します。

*XAML の場合:*
[source, xaml]
----
<Grid x:Name="layoutRoot">
    
    <ig:{ShapeChartName} x:Name="shapeChart" ChartType="Polygon">
        <ig:{ShapeChartName}.ItemsSource>
            <ig:ShapefileConverter DatabaseSource="/ShapeFiles/AirplaneBody.dbf" 
                                   ShapefileSource="/ShapeFiles/AirplaneBody.shp"/>
        </ig:{ShapeChartName}.ItemsSource>
    </ig:{ShapeChartName}>
    
</Grid>
----

*C# の場合:*
[source, csharp]
----
var shapeChart = new {ShapeChartName}();
shapeChart.ChartType = ShapeChartType.Polygon;            

var shape = new ShapefileConverter();
shape.DatabaseSource = new Uri("/ShapeFiles/AirplaneBody.dbf", UriKind.RelativeOrAbsolute);
shape.ShapefileSource = new Uri("/ShapeFiles/AirplaneBody.shp", UriKind.RelativeOrAbsolute);
            
shapeChart.ItemsSource = shape;

layoutRoot.Children.Add(shapeChart);
----

ifdef::wpf[]
*VB の場合：*
[source, vb]
----
Dim shapeChart = New {ShapeChartName}()
shapeChart.ChartType = ShapeChartType.Polygon

Dim shape = New ShapefileConverter()
shape.DatabaseSource = New Uri("/ShapeFiles/AirplaneBody.dbf", UriKind.RelativeOrAbsolute)
shape.ShapefileSource = New Uri("/ShapeFiles/AirplaneBody.shp", UriKind.RelativeOrAbsolute)

shapeChart.ItemsSource = shape

layoutRoot.Children.Add(shapeChart)
----
endif::wpf[]

上記のコードは以下のような {ShapeChartName} になります。

image:images/shapechart_shapefile_single.png[]

[[CodeExampleMulti]]
== {ShapeChartName} を複数のシェープ ファイルにバインド

以下のコード例は複数のシェープ ファイルを {ShapeChartName} にバインドする方法を紹介します。以下のコレクションを使用します。

*C# の場合:*
[source, csharp]
----
public class ShapeFileCollection : List<ShapefileConverter>
{
}
----

*XAML の場合:*
[source, xaml]
----
<Grid x:Name="layoutRoot">
    <ig:{ShapeChartName} x:Name="shapeChart" ChartType="Polygon">
        <ig:{ShapeChartName}.ItemsSource>
            <local:ShapeFileCollection>
                <ig:ShapefileConverter DatabaseSource="ShapeFiles/AirplaneBody.dbf" ShapefileSource="ShapeFiles/AirplaneBody.shp" />
                <ig:ShapefileConverter DatabaseSource="ShapeFiles/AirplaneSeats.dbf" ShapefileSource="ShapeFiles/AirplaneSeats.shp"/>
            </local:ShapeFileCollection>
        </ig:{ShapeChartName}.ItemsSource>
    </ig:{ShapeChartName}>
</Grid>
----

*C# の場合:*
[source, csharp]
----
var shapeChart = new {ShapeChartName}();
shapeChart.ChartType = ShapeChartType.Polygon;

var data = new ShapeFileCollection();

var shape1 = new ShapefileConverter();
shape1.DatabaseSource = new Uri("/ShapeFiles/AirplaneBody.dbf", UriKind.RelativeOrAbsolute);
shape1.ShapefileSource = new Uri("/ShapeFiles/AirplaneBody.shp", UriKind.RelativeOrAbsolute);

var shape2 = new ShapefileConverter();
shape2.DatabaseSource = new Uri("/ShapeFiles/AirplaneSeats.dbf", UriKind.RelativeOrAbsolute);
shape2.ShapefileSource = new Uri("/ShapeFiles/AirplaneSeats.shp", UriKind.RelativeOrAbsolute);

data.Add(shape1);
data.Add(shape2);

shapeChart.ItemsSource = data;

layoutRoot.Children.Add(shapeChart);
----


ifdef::wpf[]
*VB の場合：*
[source, vb]
----
Dim shapeChart = New {ShapeChartName}()
shapeChart.ChartType = ShapeChartType.Polygon

Dim data = New ShapeFileCollection()

Dim shape1 = New ShapefileConverter()
shape1.DatabaseSource = New Uri("/ShapeFiles/AirplaneBody.dbf", UriKind.RelativeOrAbsolute)
shape1.ShapefileSource = New Uri("/ShapeFiles/AirplaneBody.shp", UriKind.RelativeOrAbsolute)

Dim shape2 = New ShapefileConverter()
shape2.DatabaseSource = New Uri("/ShapeFiles/AirplaneSeats.dbf", UriKind.RelativeOrAbsolute)
shape2.ShapefileSource = New Uri("/ShapeFiles/AirplaneSeats.shp", UriKind.RelativeOrAbsolute)

data.Add(shape1)
data.Add(shape2)

shapeChart.ItemsSource = data

layoutRoot.Children.Add(shapeChart)
----
endif::wpf[]

上記のコードは以下のような {ShapeChartName} になります。

image:images/shapechart_shapefile_multi.png[]

[[RelatedContent]]
== 関連コンテンツ

* link:shapechart-binding-to-break-even-data.html[{ShapeChartName} で損益分岐点データのバインド]
* link:shapechart-using-legend.html[凡例の使用]